## Creates the semantic models and metrics needed for the initiative as described in https://www.notion.so/dataroots/Metrics-dae9c72b57544bc8ba85ae83efaa9a24
semantic_models:
  - name: fct_jaffleshop
    description: Model containing our jaffle shop data and metrics.
    defaults:                                
      agg_time_dimension: order_date
    model: ref('fct_jaffleshop')
    entities:
      - name: id
        type: primary
        expr: sk_id
      - name: customer
        type: foreign
        expr: customer_id

    dimensions:
      - name: order_date
        expr: order_date
        type: time
        type_params:
          time_granularity: day
      - name: customer_id
        expr: customer_id
        type: categorical

    measures:
      - name: average_payment_amount
        description: The average payment amount
        expr: amount
        agg: average
      - name: revenue
        description: The total revenue of the shop
        expr: amount
        agg: sum

metrics:
  - name: average_payment_amount_per_customer
    label: average_payment_amount_per_customer
    description: Metrics n°3 - Average amount paid per customer.
    type: cumulative
    type_params:
      measure: average_payment_amount
  - name: total_revenue
    label: total_revenue
    description: Metrics n°4 - Total revenue generated by the shop.
    type: simple
    type_params:
      measure: revenue